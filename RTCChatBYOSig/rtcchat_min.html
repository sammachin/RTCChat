<!DOCTYPE html><HTML><head><meta charset=UTF-8><title>RTCChat</title><style>body{font-family:"Helvetica Neue";font-size:20px;font-weight:normal}h1{text-align:center}section{margin:50px auto;div{max-width:255px;word-wrap:break-word;margin-bottom:20px;line-height:20px}}#sigdata{font-size:10px;font-family:Terminus,Consolas,Profont,"Andale Mono",Monaco,Inconsolata,Inconsolata-g,Unifont,Lime,"ClearlyU PUA",Clean,"DejaVu Sans Mono","Lucida Console","Bitstream Vera Sans Mono",Freemono,"Liberation Mono",Dina,Anka,Droid Sans Mono,Anonymous Pro,Proggy fonts,Envy Code R,Gamow,Courier,"Courier New",Terminal,monospace}.clear{clear:both}.to{position:relative;padding:10px 20px;color:white;background:#008080;border-radius:25px;float:right}.from{position:relative;padding:10px 20px;background:#e5e5ea;border-radius:25px;color:black;float:left}</style><script type=text/javascript>var PeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;var IceCandidate=window.RTCIceCandidate||window.mozRTCIceCandidate||window.RTCIceCandidate;var SessionDescription=window.RTCSessionDescription||window.mozRTCSessionDescription||window.RTCSessionDescription;var chatchan;var peercon;var sig;var sigdata=[];var config={iceServers:[{url:"stun:stun.services.mozilla.com"}]};var constraints={mandatory:{OfferToReceiveAudio:false,OfferToReceiveVideo:false}};function uniq(b){var c={};return b.filter(function(a){return c.hasOwnProperty(a)?false:(c[a]=true)})}function send(b,a){if(a==="null"){return}else{string={};string[b]=a}sigdata.push(string);document.getElementById("sigdata").innerHTML=JSON.stringify(sigdata)}function exec(){var a=JSON.parse(document.getElementById("siginput").value);for(s in a){method=Object.keys(a[s]);data=JSON.parse(a[s][method]);if(method=="ICE"){addIce(data)}else{if(method=="OFFER"){pickup(data)}else{if(method=="ANSWER"){connect(data)}}}}document.getElementById("siginput").value=null;document.getElementById("siginput").style.display="none";document.getElementById("exec").style.display="none"}var errorHandler=function(a){console.error(a)};function sendMsg(){var c=document.getElementById("msginput").value;chatchan.send(c);var b=document.createElement("div");var a=document.createTextNode(c);b.appendChild(a);b.className="to";document.getElementById("message").appendChild(b);document.getElementById("msginput").value=null;var b=document.createElement("div");b.className="clear";document.getElementById("message").appendChild(b)}function rxMsg(c){var b=document.createElement("div");var a=document.createTextNode(c);b.appendChild(a);b.className="from";document.getElementById("message").appendChild(b);document.getElementById("msginput").value=null;var b=document.createElement("div");b.className="clear";document.getElementById("message").appendChild(b)}function setup(){document.getElementById("messaging").style.display="none";document.getElementById("siginput").style.display="none";document.getElementById("exec").style.display="none";peercon=new PeerConnection(config,{optional:[{RtpDataChannels:true}]});peercon.onicecandidate=function(a){send("ICE",JSON.stringify(a.candidate))};chatchan=peercon.createDataChannel("chat",{});chatchan.onmessage=function(a){rxMsg(a.data)};chatchan.onopen=function(){document.getElementById("sigdata").innerHTML="";document.getElementById("signalling").style.display="none";document.getElementById("messaging").style.display="block"}}function addIce(b){var a=new IceCandidate(b);peercon.addIceCandidate(a)}function call(){peercon.createOffer(function(a){peercon.setLocalDescription(a);send("OFFER",JSON.stringify(a))},errorHandler,constraints);document.getElementById("call").style.display="none";document.getElementById("receive").style.display="none";document.getElementById("siginput").style.display="block";document.getElementById("exec").style.display="block"}function recieve(){document.getElementById("call").style.display="none";document.getElementById("receive").style.display="none";document.getElementById("siginput").style.display="block";document.getElementById("exec").style.display="block"}function pickup(a){offer=new SessionDescription(a);peercon.setRemoteDescription(offer);peercon.createAnswer(function(b){peercon.setLocalDescription(b);send("ANSWER",JSON.stringify(b))},errorHandler,constraints)}function connect(a){s=new SessionDescription(a);peercon.setRemoteDescription(s)}</script></head><body><h1 class=title>RTC Chat</h1><div id=signalling><button id=call onclick=call()>Initiate New Call</button><button id=receive onclick=recieve()>Receive a Call</button><br><br><div id=sigdata></div><textarea id=siginput rows=10 cols=80>Paste the data you are sent into here then click Process Signalling</textarea><br><button id=exec onclick=exec()>Process Signalling</button></div><div id=messaging><div id=message></div><hr><textarea id=msginput rows=2 cols=80></textarea><button id=sendmsg onclick=sendMsg()>Send Message</button></div><script type=text/javascript>setup();</script></body></HTML>